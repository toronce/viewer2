<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>íŒŒíŒŒê³  ì—°ë™ ë°ì´í„° ë·°ì–´</title>
  <style>
    body {
      font-family: 'Malgun Gothic', sans-serif;
      background: #f7f9fc;
      margin: 0;
      padding: 20px;
      line-height: 1.6;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    }
    
    .header {
      background: linear-gradient(135deg, #1ec800, #0fb300);
      color: white;
      padding: 30px;
      text-align: center;
      border-radius: 12px 12px 0 0;
    }
    
    .header h1 {
      margin: 0;
      font-size: 28px;
      font-weight: 700;
    }
    
    .content {
      padding: 30px;
    }
    
    .workflow {
      background: #e3f2fd;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      border-left: 5px solid #2196f3;
    }
    
    .workflow h3 {
      margin: 0 0 15px 0;
      color: #1976d2;
      font-size: 18px;
    }
    
    .step {
      display: flex;
      align-items: center;
      margin: 15px 0;
      padding: 15px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .step-number {
      background: #1ec800;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    .step-content {
      flex: 1;
    }
    
    .step-title {
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }
    
    .step-desc {
      color: #666;
      font-size: 14px;
    }
    
    .papago-link {
      display: inline-block;
      background: #1ec800;
      color: white;
      padding: 12px 24px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      margin: 10px 10px 10px 0;
      transition: all 0.3s;
    }
    
    .papago-link:hover {
      background: #16a085;
      transform: translateY(-2px);
    }
    
    .input-section {
      background: #f8fafc;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
    }
    
    .input-area {
      width: 100%;
      min-height: 200px;
      max-height: 400px;
      padding: 20px;
      border: 2px solid #e0e0e0;
      border-radius: 12px;
      font-size: 16px;
      font-family: 'Courier New', monospace;
      line-height: 1.6;
      resize: vertical;
      outline: none;
      background: white;
      transition: border-color 0.3s;
    }
    
    .input-area:focus {
      border-color: #1ec800;
      box-shadow: 0 0 0 4px rgba(30, 200, 0, 0.1);
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 15px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 12px 24px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      background: white;
      color: #333;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn:hover {
      border-color: #1ec800;
      background: #f0fff4;
    }
    
    .btn-primary {
      background: #1ec800;
      color: white;
      border-color: #1ec800;
    }
    
    .btn-primary:hover {
      background: #16a085;
    }
    
    .result-area {
      background: #f8fafc;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 20px;
      min-height: 200px;
      max-height: 500px;
      overflow: auto;
    }
    
    .empty-state {
      text-align: center;
      color: #9ca3af;
      font-style: italic;
      padding: 60px 20px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    }
    
    table th, table td {
      padding: 12px 16px;
      text-align: left;
      border-bottom: 1px solid #f0f0f0;
    }
    
    table th {
      background: #f8fafc;
      font-weight: 600;
      color: #374151;
    }
    
    table tr:hover {
      background: #f9fafb;
    }
    
    .alert {
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      color: #856404;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    
    .alert.success {
      background: #d4edda;
      border-color: #c3e6cb;
      color: #155724;
    }
    
    .tip {
      background: #e8f5e8;
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
      border-left: 4px solid #1ec800;
    }
    
    .tip strong {
      color: #1ec800;
    }
    
    .capture-highlight {
      border: 3px dashed #1ec800 !important;
      background: #f0fff4 !important;
    }
    
    .capture-hint {
      background: #e3f2fd;
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
      text-align: center;
      border: 2px solid #2196f3;
    }

    /* ì´ë¯¸ì§€ ìë¥´ê¸° ê´€ë ¨ ìŠ¤íƒ€ì¼ */
    .crop-container {
      position: relative;
      display: inline-block;
      max-width: 100%;
    }
    
    .crop-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      cursor: crosshair;
      z-index: 10;
    }
    
    .crop-selection {
      position: absolute;
      border: 2px dashed #1ec800;
      background: rgba(30, 200, 0, 0.1);
      pointer-events: none;
      z-index: 11;
    }
    
    .crop-controls {
      margin: 15px 0;
      text-align: center;
      display: none;
    }
    
    .crop-controls.active {
      display: block;
    }
    
    .crop-hint {
      background: #fff3cd;
      padding: 10px;
      border-radius: 6px;
      margin: 10px 0;
      font-size: 14px;
      color: #856404;
      text-align: center;
    }
    
    .crop-status {
      font-size: 12px;
      color: #666;
      margin-top: 5px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ”— íŒŒíŒŒê³  ì—°ë™ + í™”ë©´ ìº¡ì²˜ ë·°ì–´</h1>
      <p>ë³´ì•ˆ PCì—ì„œ íŒŒíŒŒê³ ë¥¼ ì¤‘ê³„ì ìœ¼ë¡œ í™œìš©í•˜ê³  í™”ë©´ ìº¡ì²˜ë¡œ ì´ë¯¸ì§€ ìš°íšŒ</p>
    </div>
    
    <div class="content">
      <div class="alert">
        <strong>ğŸ” ë¶„ì„ ê²°ê³¼:</strong> íŒŒíŒŒê³ (naver.com)ì—ì„œëŠ” ë¶™ì—¬ë„£ê¸°ê°€ ë˜ì§€ë§Œ êµ¬ê¸€ë²ˆì—­ê¸°ì—ì„œëŠ” ì•ˆ ë˜ëŠ” ì´ìœ ëŠ” <strong>ë„ë©”ì¸ ê¸°ë°˜ ë³´ì•ˆ ì •ì±…</strong> ë•Œë¬¸ì…ë‹ˆë‹¤. ë„¤ì´ë²„ ë„ë©”ì¸ë§Œ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡ë˜ì–´ ìˆì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
      </div>

      <div class="workflow">
        <h3>ğŸ›£ï¸ íŒŒíŒŒê³  ì¤‘ê³„ ì›Œí¬í”Œë¡œìš°</h3>
        
        <div class="step">
          <div class="step-number">1</div>
          <div class="step-content">
            <div class="step-title">ì—‘ì…€ ë°ì´í„° ë³µì‚¬</div>
            <div class="step-desc">ì—‘ì…€ì—ì„œ ì›í•˜ëŠ” í‘œ ë²”ìœ„ë¥¼ ì„ íƒí•˜ê³  Ctrl+Cë¡œ ë³µì‚¬</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">2</div>
          <div class="step-content">
            <div class="step-title">íŒŒíŒŒê³ ì—ì„œ ë¶™ì—¬ë„£ê¸°</div>
            <div class="step-desc">íŒŒíŒŒê³  ë²ˆì—­ì°½ì— Ctrl+Vë¡œ ë¶™ì—¬ë„£ê¸° (ë²ˆì—­ì€ í•˜ì§€ ì•Šì•„ë„ ë¨)</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">3</div>
          <div class="step-content">
            <div class="step-title">íŒŒíŒŒê³ ì—ì„œ ë‹¤ì‹œ ë³µì‚¬</div>
            <div class="step-desc">íŒŒíŒŒê³  ì…ë ¥ì°½ì˜ ë‚´ìš©ì„ ì „ì²´ ì„ íƒí•´ì„œ Ctrl+Cë¡œ ë³µì‚¬</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">4</div>
          <div class="step-content">
            <div class="step-title">ì—¬ê¸°ì— ë¶™ì—¬ë„£ê¸°</div>
            <div class="step-desc">ì•„ë˜ ì…ë ¥ì°½ì— Ctrl+Vë¡œ ë¶™ì—¬ë„£ê³  í‘œë¡œ ë³€í™˜</div>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 20px;">
          <a href="https://papago.naver.com" target="_blank" class="papago-link">
            ğŸš€ íŒŒíŒŒê³  ì—´ê¸° (ìƒˆ ì°½)
          </a>
          <a href="https://papago.naver.com" target="_blank" class="papago-link">
            ğŸ“± íŒŒíŒŒê³  ì•± ì‚¬ìš©
          </a>
        </div>
      </div>

      <div class="input-section">
        <h3>ğŸ“ ë°ì´í„° ì…ë ¥ (íŒŒíŒŒê³ ì—ì„œ ë³µì‚¬í•œ ë‚´ìš©)</h3>
        <textarea 
          class="input-area" 
          id="dataInput"
          placeholder="íŒŒíŒŒê³ ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...

ì˜ˆìƒ í˜•íƒœ:
ì´ë¦„	ë‚˜ì´	ë¶€ì„œ
í™ê¸¸ë™	30	ê°œë°œíŒ€
ê¹€ì˜í¬	25	ë””ìì¸íŒ€

ë˜ëŠ”:
ì´ë¦„, ë‚˜ì´, ë¶€ì„œ
í™ê¸¸ë™, 30, ê°œë°œíŒ€
ê¹€ì˜í¬, 25, ë””ìì¸íŒ€"
        ></textarea>
        
        <div class="controls">
          <button class="btn btn-primary" onclick="processData()">ğŸ“Š í‘œë¡œ ë³€í™˜</button>
          <button class="btn" onclick="clearData()">ğŸ—‘ï¸ ì§€ìš°ê¸°</button>
          <button class="btn" onclick="copyResult()">ğŸ“‹ ê²°ê³¼ ë³µì‚¬</button>
          <button class="btn" onclick="downloadCSV()">ğŸ’¾ CSV ë‹¤ìš´ë¡œë“œ</button>
          <button class="btn" onclick="startScreenCapture()">ğŸ“¸ í™”ë©´ ìº¡ì²˜</button>
        </div>
        
        <div class="tip">
          <strong>ğŸ’¡ í•µì‹¬ íŒ:</strong> íŒŒíŒŒê³ ëŠ” ë³´ì•ˆ PCì—ì„œë„ í´ë¦½ë³´ë“œê°€ í—ˆìš©ë˜ë¯€ë¡œ, íŒŒíŒŒê³ ë¥¼ "ì¤‘ê³„ì "ìœ¼ë¡œ í™œìš©í•˜ë©´ ë°ì´í„°ë¥¼ ì•ˆì „í•˜ê²Œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!
        </div>
      </div>
      
      <div class="input-section">
        <h3>ğŸ“Š ë³€í™˜ ê²°ê³¼</h3>
        <div class="result-area" id="resultArea">
          <div class="empty-state">
            ìœ„ì— ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  "í‘œë¡œ ë³€í™˜" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”
          </div>
        </div>
      </div>

      <!-- ìº¡ì²˜ëœ ì´ë¯¸ì§€ í‘œì‹œ ì˜ì—­ -->
      <div class="input-section" id="captureSection" style="display: none;">
        <h3>ğŸ“¸ ìº¡ì²˜ëœ ì´ë¯¸ì§€</h3>
        <div class="tip">
          <strong>ğŸ’¡ ì‚¬ìš©ë²•:</strong> ì•„ë˜ ì´ë¯¸ì§€ì—ì„œ <strong>ìš°í´ë¦­ â†’ "ì´ë¯¸ì§€ ë³µì‚¬"</strong> í›„ ë‹¤ë¥¸ ì•±ì—ì„œ Ctrl+Vë¡œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
        </div>
        <div class="capture-hint">
          <strong>ğŸ¯ ì´ê²ƒì´ í•µì‹¬ì…ë‹ˆë‹¤!</strong><br>
          ì›¹ ì´ë¯¸ì§€ëŠ” ìš°í´ë¦­ìœ¼ë¡œ ë³µì‚¬ ê°€ëŠ¥ â†’ íšŒì‚¬ ì´ë©”ì¼, PPT, ì›Œë“œì— ë¶™ì—¬ë„£ê¸° ê°€ëŠ¥!
        </div>
        
        <div class="crop-hint" id="cropHint">
          <strong>âœ‚ï¸ ì´ë¯¸ì§€ ìë¥´ê¸°:</strong> ë§ˆìš°ìŠ¤ë¡œ ë“œë˜ê·¸í•˜ì—¬ ì›í•˜ëŠ” ì˜ì—­ì„ ì„ íƒí•˜ê³  "ìë¥´ê¸°" ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”
        </div>
        
        <div style="text-align: center; background: white; padding: 20px; border-radius: 8px;" class="capture-highlight">
          <div class="crop-container" id="cropContainer">
            <img id="capturedImage" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" />
            <div class="crop-overlay" id="cropOverlay"></div>
            <div class="crop-selection" id="cropSelection"></div>
          </div>
          
          <div class="crop-controls" id="cropControls">
            <button class="btn" onclick="cropImage()">âœ‚ï¸ ìë¥´ê¸°</button>
            <button class="btn" onclick="resetCrop()">ğŸ”„ ì„ íƒ ì´ˆê¸°í™”</button>
            <button class="btn" onclick="restoreOriginal()">â†©ï¸ ì›ë³¸ìœ¼ë¡œ</button>
            <div class="crop-status" id="cropStatus">ì„ íƒëœ ì˜ì—­ ì—†ìŒ</div>
          </div>
          
          <div style="margin-top: 15px; color: #666; font-size: 14px;">
            â˜ï¸ ì´ ì´ë¯¸ì§€ë¥¼ ìš°í´ë¦­í•˜ì—¬ "ì´ë¯¸ì§€ ë³µì‚¬"ë¥¼ ì„ íƒí•˜ì„¸ìš”
          </div>
        </div>
        <div style="text-align: center; margin-top: 15px;">
          <button class="btn" onclick="clearCapture()">ğŸ—‘ï¸ ìº¡ì²˜ ì‚­ì œ</button>
          <button class="btn" onclick="startScreenCapture()">ğŸ“¸ ë‹¤ì‹œ ìº¡ì²˜</button>
          <button class="btn" onclick="downloadImage()">ğŸ’¾ ì´ë¯¸ì§€ ì €ì¥</button>
        </div>
      </div>

      <!-- ì¶”ê°€ íŒ ì„¹ì…˜ -->
      <div class="workflow">
        <h3>ğŸ¯ í™”ë©´ ìº¡ì²˜ í™œìš©ë²•</h3>
        
        <div class="step">
          <div class="step-number">ğŸ“¸</div>
          <div class="step-content">
            <div class="step-title">ì•„ë¬´ê±°ë‚˜ ìº¡ì²˜ ê°€ëŠ¥</div>
            <div class="step-desc">PDF, PPT, ì´ë¯¸ì§€, ì›¹í˜ì´ì§€ ë“± í™”ë©´ì— ë³´ì´ëŠ” ëª¨ë“  ê²ƒì„ ìº¡ì²˜</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">ğŸ–¼ï¸</div>
          <div class="step-content">
            <div class="step-title">ì›¹ ì´ë¯¸ì§€ë¡œ ë³€í™˜</div>
            <div class="step-desc">ìº¡ì²˜í•œ ë‚´ìš©ì´ ì´ ì›¹í˜ì´ì§€ì— ì´ë¯¸ì§€ë¡œ í‘œì‹œë¨</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">ğŸ‘†</div>
          <div class="step-content">
            <div class="step-title">ìš°í´ë¦­ìœ¼ë¡œ ë³µì‚¬</div>
            <div class="step-desc">ì›¹ ì´ë¯¸ì§€ë¥¼ ìš°í´ë¦­ â†’ "ì´ë¯¸ì§€ ë³µì‚¬" â†’ ë‹¤ë¥¸ ì•±ì— ë¶™ì—¬ë„£ê¸°</div>
          </div>
        </div>
        
        <div class="step">
          <div class="step-number">ğŸ“§</div>
          <div class="step-content">
            <div class="step-title">ì–´ë””ë“  ë¶™ì—¬ë„£ê¸°</div>
            <div class="step-desc">íšŒì‚¬ ì´ë©”ì¼, PPT, ì›Œë“œ, ë©”ëª¨ì¥ ë“±ì— Ctrl+Vë¡œ ë¶™ì—¬ë„£ê¸°</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const dataInput = document.getElementById('dataInput');
    const resultArea = document.getElementById('resultArea');

    // ì…ë ¥ ê°ì§€
    dataInput.addEventListener('paste', function() {
      setTimeout(() => {
        if (dataInput.value.trim()) {
          showAlert('íŒŒíŒŒê³ ì—ì„œ ë°ì´í„°ê°€ ì „ë‹¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        }
      }, 100);
    });

    // ì•Œë¦¼ í‘œì‹œ
    function showAlert(message, type = 'info') {
      const existingAlert = document.querySelector('.alert.dynamic');
      if (existingAlert) {
        existingAlert.remove();
      }
      
      const alert = document.createElement('div');
      alert.className = `alert dynamic ${type}`;
      alert.innerHTML = `<strong>ğŸ“¢</strong> ${message}`;
      
      const content = document.querySelector('.content');
      content.insertBefore(alert, content.firstChild);
      
      setTimeout(() => {
        alert.remove();
      }, 3000);
    }

    // ë°ì´í„° ì²˜ë¦¬
    function processData() {
      const inputText = dataInput.value.trim();
      
      if (!inputText) {
        showAlert('íŒŒíŒŒê³ ì—ì„œ ë³µì‚¬í•œ ë°ì´í„°ë¥¼ ë¨¼ì € ë¶™ì—¬ë„£ì–´ ì£¼ì„¸ìš”!', 'error');
        return;
      }

      try {
        const result = parseTextToTable(inputText);
        resultArea.innerHTML = result;
        showAlert('í‘œ ë³€í™˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
      } catch (error) {
        showAlert('ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤!', 'error');
      }
    }

    // í…ìŠ¤íŠ¸ë¥¼ í‘œë¡œ ë³€í™˜
    function parseTextToTable(text) {
      const lines = text.split('\n').filter(line => line.trim());
      
      if (lines.length === 0) {
        return '<div class="empty-state">ë³€í™˜í•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
      }

      // êµ¬ë¶„ì ìë™ ê°ì§€
      let delimiter = detectDelimiter(lines[0]);
      
      let html = '<table>';
      
      lines.forEach((line, index) => {
        html += '<tr>';
        
        const cells = line.split(delimiter);
        cells.forEach(cellText => {
          const tag = index === 0 ? 'th' : 'td';
          const cleanText = cellText.trim() || '&nbsp;';
          html += `<${tag}>${cleanText}</${tag}>`;
        });
        
        html += '</tr>';
      });
      
      html += '</table>';
      
      const delimiterName = delimiter === '\t' ? 'íƒ­' : 
                           delimiter === ',' ? 'ì½¤ë§ˆ' : 
                           delimiter === '|' ? 'íŒŒì´í”„' : 'ê³µë°±';
      
      html += `<div style="text-align: center; color: #666; margin-top: 15px; font-size: 14px;">
        ğŸ“Š ${lines.length}í–‰ Ã— ${lines[0].split(delimiter).length}ì—´ 
        (êµ¬ë¶„ì: ${delimiterName}) | íŒŒíŒŒê³  ê²½ìœ  ì „ì†¡ ì™„ë£Œ âœ…
      </div>`;
      
      return html;
    }

    // êµ¬ë¶„ì ê°ì§€
    function detectDelimiter(line) {
      if (line.includes('\t')) return '\t';
      if (line.includes(',')) return ',';
      if (line.includes('|')) return '|';
      return /\s+/;
    }

    // ë°ì´í„° ì§€ìš°ê¸°
    function clearData() {
      if (confirm('ì…ë ¥ëœ ë°ì´í„°ë¥¼ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        dataInput.value = '';
        resultArea.innerHTML = '<div class="empty-state">ìœ„ì— ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê³  "í‘œë¡œ ë³€í™˜" ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</div>';
        showAlert('ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤', 'success');
      }
    }

    // ê²°ê³¼ ë³µì‚¬
    function copyResult() {
      try {
        const tables = resultArea.querySelectorAll('table');
        if (tables.length === 0) {
          showAlert('ë³µì‚¬í•  í‘œê°€ ì—†ìŠµë‹ˆë‹¤!', 'error');
          return;
        }

        let textContent = '';
        tables[0].querySelectorAll('tr').forEach(row => {
          const cells = Array.from(row.querySelectorAll('th, td'));
          const rowText = cells.map(cell => cell.textContent.trim()).join('\t');
          textContent += rowText + '\n';
        });

        const tempTextarea = document.createElement('textarea');
        tempTextarea.value = textContent;
        document.body.appendChild(tempTextarea);
        tempTextarea.select();
        
        if (document.execCommand('copy')) {
          showAlert('í‘œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
        } else {
          throw new Error('ë³µì‚¬ ì‹¤íŒ¨');
        }
        
        document.body.removeChild(tempTextarea);
      } catch (error) {
        showAlert('ë³µì‚¬ ê¸°ëŠ¥ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    // CSV ë‹¤ìš´ë¡œë“œ
    function downloadCSV() {
      const tables = resultArea.querySelectorAll('table');
      if (tables.length === 0) {
        showAlert('ë‹¤ìš´ë¡œë“œí•  í‘œê°€ ì—†ìŠµë‹ˆë‹¤!', 'error');
        return;
      }

      let csvContent = '';
      tables[0].querySelectorAll('tr').forEach(row => {
        const cells = Array.from(row.querySelectorAll('th, td'));
        const rowText = cells.map(cell => `"${cell.textContent.trim()}"`).join(',');
        csvContent += rowText + '\n';
      });

      try {
        const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv; charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `papago_data_${new Date().toISOString().slice(0, 10)}.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        showAlert('CSV íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
      } catch (error) {
        showAlert('ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤', 'error');
      }
    }

    // í™”ë©´ ìº¡ì²˜ ì‹œì‘
    async function startScreenCapture() {
      try {
        showAlert('í™”ë©´ ìº¡ì²˜ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤. ìº¡ì²˜í•  ì˜ì—­ì„ ì„ íƒí•˜ì„¸ìš”!', 'info');
        
        // Screen Capture API ì‚¬ìš©
        const stream = await navigator.mediaDevices.getDisplayMedia({
          video: {
            mediaSource: 'screen',
            width: { ideal: 1920 },
            height: { ideal: 1080 }
          }
        });
        
        // ë¹„ë””ì˜¤ ìš”ì†Œ ìƒì„±
        const video = document.createElement('video');
        video.srcObject = stream;
        video.play();
        
        // ë¹„ë””ì˜¤ê°€ ë¡œë“œë˜ë©´ ìº”ë²„ìŠ¤ë¡œ ë³€í™˜
        video.addEventListener('loadedmetadata', () => {
          const canvas = document.createElement('canvas');
          const ctx = canvas.getContext('2d');
          
          // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •
          canvas.width = video.videoWidth;
          canvas.height = video.videoHeight;
          
          // ì²« í”„ë ˆì„ ìº¡ì²˜
          ctx.drawImage(video, 0, 0);
          
          // ìŠ¤íŠ¸ë¦¼ ì •ì§€
          stream.getTracks().forEach(track => track.stop());
          
          // ìº¡ì²˜ëœ ì´ë¯¸ì§€ë¥¼ Data URLë¡œ ë³€í™˜
          const imageDataUrl = canvas.toDataURL('image/png', 1.0);
          
          // ì›¹í˜ì´ì§€ì— ì´ë¯¸ì§€ í‘œì‹œ
          displayCapturedImage(imageDataUrl);
          
          showAlert('ğŸ‰ ìº¡ì²˜ ì™„ë£Œ! ì•„ë˜ ì´ë¯¸ì§€ë¥¼ ìš°í´ë¦­í•˜ì—¬ ë³µì‚¬í•˜ì„¸ìš”!', 'success');
          
        });
        
      } catch (error) {
        console.error('í™”ë©´ ìº¡ì²˜ ì‹¤íŒ¨:', error);
        
        if (error.name === 'NotAllowedError') {
          showAlert('âŒ í™”ë©´ ìº¡ì²˜ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
        } else if (error.name === 'NotSupportedError') {
          showAlert('âŒ ì´ ë¸Œë¼ìš°ì €ëŠ” í™”ë©´ ìº¡ì²˜ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Chromeì´ë‚˜ Edgeë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”.', 'error');
        } else {
          showAlert('âŒ í™”ë©´ ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
        }
      }
    }
    
    // ìº¡ì²˜ëœ ì´ë¯¸ì§€ë¥¼ ì›¹í˜ì´ì§€ì— í‘œì‹œ
    function displayCapturedImage(imageDataUrl) {
      const captureSection = document.getElementById('captureSection');
      const capturedImage = document.getElementById('capturedImage');
      
      // ì´ë¯¸ì§€ ì„¤ì •
      capturedImage.src = imageDataUrl;
      capturedImage.alt = 'ìº¡ì²˜ëœ ì´ë¯¸ì§€';
      originalImageData = imageDataUrl; // ì›ë³¸ ì´ë¯¸ì§€ ì €ì¥
      
      // ìš°í´ë¦­ ë°©ì§€ í•´ì œ (ë³µì‚¬ë¥¼ ìœ„í•´)
      capturedImage.oncontextmenu = function() {
        return true; // ìš°í´ë¦­ í—ˆìš©
      };
      
      // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ í›„ ìë¥´ê¸° ì´ë²¤íŠ¸ ì„¤ì •
      capturedImage.onload = function() {
        setupCropEvents();
        resetCrop();
      };
      
      // ìº¡ì²˜ ì„¹ì…˜ í‘œì‹œ
      captureSection.style.display = 'block';
      
      // ìº¡ì²˜ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
      captureSection.scrollIntoView({ behavior: 'smooth' });
    }
    
    // ìº¡ì²˜ ì‚­ì œ
    function clearCapture() {
      const captureSection = document.getElementById('captureSection');
      const capturedImage = document.getElementById('capturedImage');
      
      capturedImage.src = '';
      captureSection.style.display = 'none';
      originalImageData = null;
      resetCrop();
      
      showAlert('ìº¡ì²˜ëœ ì´ë¯¸ì§€ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    }

    // ì´ˆê¸°í™”
    dataInput.focus();

    // ì´ë¯¸ì§€ ìë¥´ê¸° ê´€ë ¨ ë³€ìˆ˜
    let isSelecting = false;
    let cropStartX = 0;
    let cropStartY = 0;
    let cropEndX = 0;
    let cropEndY = 0;
    let originalImageData = null;

    // ì´ë¯¸ì§€ ìë¥´ê¸° ì´ë²¤íŠ¸ ì„¤ì •
    function setupCropEvents() {
      const cropOverlay = document.getElementById('cropOverlay');
      const cropSelection = document.getElementById('cropSelection');
      const cropControls = document.getElementById('cropControls');
      const cropStatus = document.getElementById('cropStatus');
      
      if (!cropOverlay) return;
      
      cropOverlay.addEventListener('mousedown', startCrop);
      cropOverlay.addEventListener('mousemove', updateCrop);
      cropOverlay.addEventListener('mouseup', endCrop);
      cropOverlay.addEventListener('mouseleave', endCrop);
      
      function startCrop(e) {
        isSelecting = true;
        const rect = cropOverlay.getBoundingClientRect();
        cropStartX = e.clientX - rect.left;
        cropStartY = e.clientY - rect.top;
        cropEndX = cropStartX;
        cropEndY = cropStartY;
        
        cropSelection.style.display = 'block';
        updateCropSelection();
      }
      
      function updateCrop(e) {
        if (!isSelecting) return;
        
        const rect = cropOverlay.getBoundingClientRect();
        cropEndX = e.clientX - rect.left;
        cropEndY = e.clientY - rect.top;
        
        updateCropSelection();
      }
      
      function endCrop(e) {
        if (!isSelecting) return;
        isSelecting = false;
        
        const width = Math.abs(cropEndX - cropStartX);
        const height = Math.abs(cropEndY - cropStartY);
        
        if (width > 10 && height > 10) {
          cropControls.classList.add('active');
          cropStatus.textContent = `ì„ íƒëœ ì˜ì—­: ${Math.round(width)} Ã— ${Math.round(height)} px`;
        } else {
          resetCrop();
        }
      }
      
      function updateCropSelection() {
        const left = Math.min(cropStartX, cropEndX);
        const top = Math.min(cropStartY, cropEndY);
        const width = Math.abs(cropEndX - cropStartX);
        const height = Math.abs(cropEndY - cropStartY);
        
        cropSelection.style.left = left + 'px';
        cropSelection.style.top = top + 'px';
        cropSelection.style.width = width + 'px';
        cropSelection.style.height = height + 'px';
      }
    }
    
    // ìë¥´ê¸° ì‹¤í–‰
    function cropImage() {
      const capturedImage = document.getElementById('capturedImage');
      const cropSelection = document.getElementById('cropSelection');
      
      if (!capturedImage.src || !cropSelection.style.width) {
        showAlert('ìë¥¼ ì˜ì—­ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”!', 'error');
        return;
      }
      
      try {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        
        // ì´ë¯¸ì§€ ì‹¤ì œ í¬ê¸° ê³„ì‚°
        const img = new Image();
        img.onload = function() {
          const displayRect = capturedImage.getBoundingClientRect();
          const scaleX = img.width / capturedImage.offsetWidth;
          const scaleY = img.height / capturedImage.offsetHeight;
          
          const cropLeft = Math.min(cropStartX, cropEndX) * scaleX;
          const cropTop = Math.min(cropStartY, cropEndY) * scaleY;
          const cropWidth = Math.abs(cropEndX - cropStartX) * scaleX;
          const cropHeight = Math.abs(cropEndY - cropStartY) * scaleY;
          
          canvas.width = cropWidth;
          canvas.height = cropHeight;
          
          ctx.drawImage(img, cropLeft, cropTop, cropWidth, cropHeight, 0, 0, cropWidth, cropHeight);
          
          const croppedImageData = canvas.toDataURL('image/png', 1.0);
          capturedImage.src = croppedImageData;
          
          resetCrop();
          showAlert('ğŸ‰ ì´ë¯¸ì§€ê°€ ì„±ê³µì ìœ¼ë¡œ ì˜ë ¸ìŠµë‹ˆë‹¤!', 'success');
        };
        img.src = capturedImage.src;
        
      } catch (error) {
        console.error('ì´ë¯¸ì§€ ìë¥´ê¸° ì‹¤íŒ¨:', error);
        showAlert('âŒ ì´ë¯¸ì§€ ìë¥´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      }
    }
    
    // ìë¥´ê¸° ì„ íƒ ì´ˆê¸°í™”
    function resetCrop() {
      const cropSelection = document.getElementById('cropSelection');
      const cropControls = document.getElementById('cropControls');
      const cropStatus = document.getElementById('cropStatus');
      
      cropSelection.style.display = 'none';
      cropControls.classList.remove('active');
      cropStatus.textContent = 'ì„ íƒëœ ì˜ì—­ ì—†ìŒ';
      
      isSelecting = false;
      cropStartX = cropStartY = cropEndX = cropEndY = 0;
    }
    
    // ì›ë³¸ ì´ë¯¸ì§€ë¡œ ë³µì›
    function restoreOriginal() {
      const capturedImage = document.getElementById('capturedImage');
      
      if (!originalImageData) {
        showAlert('ì›ë³¸ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤!', 'error');
        return;
      }
      
      capturedImage.src = originalImageData;
      resetCrop();
      showAlert('ğŸ”„ ì›ë³¸ ì´ë¯¸ì§€ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
    }

    // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
    function downloadImage() {
      const capturedImage = document.getElementById('capturedImage');
      
      if (!capturedImage.src) {
        showAlert('ë‹¤ìš´ë¡œë“œí•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤!', 'error');
        return;
      }
      
      try {
        const link = document.createElement('a');
        link.download = `captured_image_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.png`;
        link.href = capturedImage.src;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        showAlert('ğŸ‰ ì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
      } catch (error) {
        showAlert('âŒ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥ì´ ì œí•œë˜ì–´ ìˆìŠµë‹ˆë‹¤', 'error');
      }
    }
  </script>
</body>
</html>
